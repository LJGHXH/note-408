# 408计算机组成原理导学和概论

## 导学

### 2023年更新

#### 增加部分

- 计算机性能指标增加了EFLOPS和ZFLOPS
- 微指令格式

#### 改动部分

- “微指令编码方式”改为“微命令的编码方式”

#### 删除部分

- 计算机发展历程，BCD码，校验码
- 总线仲裁
- 集中仲裁方式，分布仲裁方式
- 光盘存储器

### 课程内容

1. 计算机系统概论
2. 数据的表示和运算
3. 存储器层次结构
4. 指令系统
5. 中央处理器
6. 总线系统
7. 输入输出系统

**重点**：2，3，4，5  
**次重点**：6，7

## 概论 > 基本组成

计算机系统由软硬件共同构成。

计算机的4个基本功能包括：数据的加工、保存、传送，操作控制。

电子计算机分为：电子模拟计算机（数值由连续量表示，计算过程连续），电子数字计算机（用数目字表示数量大小，按位运算，不连续地跳动计算）。

数字计算机分为：专用计算机，通用计算机。

通用计算机分类，体积、功耗、性能、数据存储量、指令系统、价格、**复杂性**由低到高：  
单片机，微型机，工作站，服务器，大型机，超级计算机

### 早期冯诺依曼机

冯诺依曼提出了“**存储程序**”的概念。  
将指令实现以二进制代码输入主存储器，随后在存储器中的首地址执行第一条，规定程序按地址顺序地执行其它指令，直到程序执行结束。

冯诺依曼机特点：

1. 计算机由**运算器、控制器、存储器、输入、输出**组成
2. 指令和数据以同等地位放入存储器，可按地址寻访
3. 指令和数据用二进制数表示
4. 指令由操作码和地址码组成，操作码用来表示操作性质，地址码用来表示操作数在存储器重点位置
5. 指令在存储器内按顺序存放
6. 机器以运算器为中心，输入输出设备与存储器间数据通过运算器完成。

### 现代计算机的组织结构

控制器ALU、控制器CU构成CPU，主存、辅存构成存储器，  
CPU、主存构成主机，主机、辅存、I/O设备共同组成一台计算机硬件。

### 计算机的功能组件

#### I/O设备

（输入设备、输出设备）让计算机能够与外界联系

#### 存储器

存放程序和数据，分为主存储器（简称主存，包括缓存、内存）和辅助存储器（辅存，也称外存）。

CPU能够直接访问主存，辅存必须讲信息调入主存，才能被CPU访问。  

**存储器特点**：

- 主存包括存储体、地址MAR、数据MDR，数据在存储体内存地址存储，MAR位数反应存储单元个数，MDR位数=存储字长
  - MAR = 4位：总共有`2^4`个存储单元
  - MDR = 16位：每个存储单元可存放16bit
  - 1个字word = 16bit
  - 1个字节Byte = 1B = 8bit = 8b
- 由存储体、存储单元、存储元件(0/1)组成（大楼-房间-床位(无人/有人)）
- 存储单元存放一串二进制代码
- 存储字是存储单元的二进制代码组合
- 存储字长是存储单元中二进制代码的位数，每个存储单元赋予一个地址号
- 按地址寻访

2^12 | 2^11 | 2^10 | 2^9 | 2^8 | 2^7 | 2^6 | 2^5 | 2^4 | 2^3 | 2^2 | 2^1
-|-|-|-|-|-|-|-|-|-|-|-
4096 | 2048 | 1024 | 512 | 256 | 128 | 64 | 32 | 16 | 8 | 4 | 2 | 1

**存储容量**：

1K = 2^10, 1M = 2^20, 1G = 2^30  
1TB = 1024GB  
1PB = 1024TB  
EB，ZB，YB，BB依此类推1024数量级换算

#### 运算器ALU

运算器的核心是算术逻辑存储单元，用于暂存操作数和中间结果，**累加器ACC、乘商寄存器MQ、操作数寄存器X**，变址寄存器IX、基址寄存器BR等，前三个寄存器是必须的

程序状态寄存器PSW（标志寄存器），存放ALU运算得到的一些标志信息或处理及的状态信息，包括结果是否溢出、有无产生仅为或错位、结果是否为负等。

X -> ALU <-> ACC <-> MQ

1. ACC：累加器，用于存放操作数，或运算结果
2. MQ：乘商寄存器，乘除运算时，存放操作数和运算结果
3. X：通用的操作数寄存器，用于存放操作数
4. ALU：算术逻辑单元，通过内部复杂电路实现算数运算、逻辑运算

_      |    加  |   减  |   乘  |   除
-|-|-|-|-
ACC    |   被加数、和  |   被减数、差  |   乘积高位       |   被除数、余数
MQ     |              |              |   乘数、乘积高位  |   商
X      |    加数      |     减数      |     被乘数       |   余数

#### 控制器

向计算机提供每一时刻协同运行所需的控制信号：

1. 正确分析与执行每条指令：取指令 -> 分析指令 -> 执行指令（指令周期）
2. 保证指令按规定序列自动连续地执行
3. 对各种异常情况和请求及时响应和处理

控制器由PC、IR、CU组成：  
PC存放当前欲执行行指令的地址，具有计数功能：(PC) + 1 -> PC；  
IR存放当前欲执行指令；  
CU执行指令。

## 概论 > 计算机软件

软件分为**系统软件**（操作系统、标准程序库、语言处理、服务程序、数据库管理系统、软件）、**应用软件**（面向用户根据特殊需求编制的应用程序）。

软件与硬件具有**逻辑等价性**。任何操作、指令都可以由软件或硬件实现。

### 计算机的工作过程

1. 把程序和数据装入主存储器；
2. 将源程序转换成可执行文件；
3. 从可执行文件的首地址开始逐条执行指令。

### 计算机系统层次结构

**软件**：  
虚拟机器M4（高级语言机器，用编译程序返程汇编语言程序）  
↓  
虚拟机M3（汇编语言及其，用汇编程序翻译成机器语言程序）  
↓  
虚拟机M2（用机器语言解释操作系统）  
↓  
**硬件**：  
实际机器M1（用机器语言的机器，用微指令解释机器指令）  
↓  
微程序机器M0（由硬件直接执行微指令）

### 计算机性能指标

**存储器**：总容量 = 存储单元个数 × 存储字长bit  
= 存储单元个数 × 存储字长/8bit  
1Byte = 8bit

**存储器容量**：存储器中所有存储单元的总数目，单位：KB、MB、GB、TB

**吞吐量**：计算机在某一时间间隔内能够处理的信息量，单位：字节/秒（B/S）

**响应时间**：有效输入到系统产生响应之间的时间，单位：秒

**利用率**：给定时间间隔内，系统被实际使用的事件所占比率，用%表示

**处理机字长**：处理机运算器中一次能完成的二进制位数，字长越长，精度越高

**总线宽度**：CPU中运算器与存储器间进行互联的总线二进制位数

**存储器带宽**：单位时间内从存储器读出的二进制数信息量，单位：字节/秒（B/S）

**主频**：主时钟的频率f，主时钟不断产生固定频率的时钟，CPU工作节拍受主时钟控制，单位：MHz、GHz

**时钟周期**：主频的倒数是时钟周期T，`T = 1/f`，单位：微秒，纳秒

**CPU执行时间**：CPU执行一段程序所占用CPU的时间 `tcpu`，  
`CPU执行时间 = CPU时钟周期数 × CPU时钟周期`  
`tcpu = Nc × T`

**CPI**：每条指令的平均周期数，执行一条指令所需的平均始终周期数，  
`CPI = Nc / In` // In是指令的数量  
`执行一条指令的耗时 = CPI × CPU时钟周期`  
`CPU执行时间 = CPU时钟周期数 / 主频 = (指令条数 × CPI) / 主频`

**IPS**：每秒指令条数，`IPS = 主频 / 平均CPI`

**FLOPS**：每秒执行的浮点运算次数

**MIPS**：每秒执行百万条的指令数，`MIPS = 指令条数 / (程序执行时间 × 10^6)`

**MFLOPS**：每秒百万次浮点操作次数，`MFLOPS = 程序中浮点操作次数 / (程序执行时间 × 10^6)`

## 补充知识点

速度比较：寄存器 > Cache > 内存

MAR的位数决定了地址码长度，MDR位数（存储单元的二进制位数）决定了存储字长

8位的计算机系统以16位表示地址，意味着处理机字长8位、MAR有16位，它有`2^16 = 65536`个地址空间

CPU是依据指令周期的不同阶段，来区分存储器中的指令和数据

计算机硬件能够直接执行的只有机器语言  
汇编语言还需要翻译为机器语言才能被硬件执行  
硬件描述语言用于设计大规模电路

指令和数据都用二进制表示，形式上无差别，所以需要指令周期来区分。数据不一定在指令中直接给出。

位数一定与机器字长相同的是ALU、通用寄存器

1G = 10^9, 1M = 10^6
